<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.teams.mapper.ProductSjMapper">
     
     <select id="selectcpdash" resultType="D_file">
        select a.*,b.fname,c.tname,d.pname from d_file a,feilei b,type c,pclass d
        where a.fid=b.fid and 
        a.tid=c.tid and 
        a.pid=d.pid and  
        a.check_tag=#{check_tag}
     </select>
     
     <select id="selecttype" resultType="Type">
        select * from type
     </select>
     
     <select id="selectpclass" resultType="Pclass">
        select * from pclass
     </select>
     
     <update id="updfh">
        update d_file set product_name=#{product_name},factory_name=#{factory_name},
        product_nick=#{product_nick},tid=#{tid},pid=#{pid},personal_unit=#{personal_unit},
        personal_value=#{personal_value},provider_group=#{provider_group},list_price=#{list_price},
        cost_price=#{cost_price},amount_unit=#{amount_unit},warranty=#{warranty},twin_name=#{twin_name},
        twin_id=#{twin_id},lifecycle=#{lifecycle},responsible_person=#{responsible_person},register=#{register},
        check_tag=#{check_tag},checker=#{checker},check_time=now() 
        where product_id=#{product_id}
     </update>
     
     <select id="selectddfh" resultType="int">
        SELECT count(1) from d_file where check_tag=#{check_tag}
     </select>
     
     <select id="selecttgfh" resultType="int">
        SELECT count(1) from d_file where check_tag=#{check_tag}
     </select>
     
     
     
     <!-- 产品物料设计单审核查询 -->
     <select id="selectwusjsh" resultType="D_module">
        select * from D_module where check_tag=#{check_tag}
     </select>
     <select id="selectwuddshsum" resultType="int">
        SELECT count(1) from D_module where check_tag=#{check_tag}
     </select>
     <select id="selectwlmx" resultType="D_module_details">
        select * from D_module_details where design_id=#{design_id}
     </select>
     <update id="updatewlsh">
        update D_module set module_describe=#{module_describe},checker=#{checker},check_time=now(),check_tag=#{check_tag}
        where design_id=#{design_id}
     </update>
     <!-- 物料组成设计不通过 -->
     <delete id="delwlsjmx">
        delete from D_module_details where design_id=#{String design_id}
     </delete>
     <update id="updcpdnwlsj">
        update d_file set design_module_tag=#{design_module_tag} where product_id=#{product_id}
     </update>
     <delete id="delwlsj">
        delete from D_module where design_id=#{design_id}
     </delete>
     
  </mapper>